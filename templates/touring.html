<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>{% if artist_query %}{{ artist_query }} Tour Dates & Concert Tickets{% elif venue_query %}{{ venue_query }} Events & Concert Schedule{% elif multi_artist %}Multi-Artist Concert Search Results{% else %}Concert Tour Dates & Live Music Events | Music Hub{% endif %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="{% if artist_query %}Find {{ artist_query }} tour dates, concert tickets, and live show information. Get tickets to upcoming performances near you.{% elif venue_query %}Browse all upcoming events at {{ venue_query }}. Find concert dates, ticket prices, and venue information.{% else %}Discover live music events and concert tour dates from top artists. Browse upcoming shows by genre, location, and date. Get tickets to concerts near you.{% endif %}">
  <meta name="keywords" content="concert tickets, tour dates, live music, {{ artist_query if artist_query else 'music events' }}, concert venues, ticket prices, music festivals, live shows, upcoming concerts">
  <meta name="author" content="Music Hub">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  <meta name="theme-color" content="#ec4899">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://music-news-site.onrender.com/touring{% if artist_query %}?artist={{ artist_query|urlencode }}{% endif %}">
  <meta property="og:title" content="{% if artist_query %}{{ artist_query }} Tour Dates{% else %}Concert Tours & Live Music Events{% endif %}">
  <meta property="og:description" content="{% if artist_query %}Get tickets to {{ artist_query }} concerts and find tour dates near you.{% else %}Discover live music events, concert tour dates, and get tickets to upcoming shows.{% endif %}">
  <meta property="og:image" content="https://music-news-site.onrender.com{{ url_for('static', filename='icon-512.png') }}">
  <meta property="og:site_name" content="Music Hub">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://music-news-site.onrender.com/touring">
  <meta name="twitter:title" content="{% if artist_query %}{{ artist_query }} Tour Dates{% else %}Concert Tours & Live Music{% endif %}">
  <meta name="twitter:description" content="Find concert tickets and tour dates for live music events">
  <meta name="twitter:image" content="https://music-news-site.onrender.com{{ url_for('static', filename='icon-512.png') }}">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://music-news-site.onrender.com/touring">
  
  <!-- PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Music Hub Tours">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='icon-192.png') }}">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="192x192" href="{{ url_for('static', filename='icon-192.png') }}">
  <link rel="icon" type="image/png" sizes="512x512" href="{{ url_for('static', filename='icon-512.png') }}">
  
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <script src="{{ url_for('static', filename='app.js') }}" defer></script>
  
  <!-- Structured Data / JSON-LD for Events -->
  {% if tours and (artist_query or venue_query or multi_artist) %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "EventSeries",
    "name": "{% if artist_query %}{{ artist_query }} Concert Tour{% elif venue_query %}{{ venue_query }} Events{% else %}Music Concerts{% endif %}",
    "description": "{% if artist_query %}Live concert tour dates and ticket information for {{ artist_query }}{% else %}Upcoming music events and live concerts{% endif %}",
    "url": "https://music-news-site.onrender.com/touring{% if artist_query %}?artist={{ artist_query|urlencode }}{% endif %}",
    "organizer": {
      "@type": "Organization",
      "name": "Music Hub",
      "url": "https://music-news-site.onrender.com"
    }
  }
  </script>
  {% endif %}
  
  <!-- Structured Data for Website -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Music Hub Concert Tours",
    "description": "Find concert tour dates, live music events, and ticket information for artists worldwide",
    "url": "https://music-news-site.onrender.com/touring",
    "applicationCategory": "EntertainmentApplication",
    "operatingSystem": "All",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": "Concert search, Tour dates, Ticket prices, Venue information, Artist following, Social sharing, Advanced search"
  }
  </script>
</head>
<body itemscope itemtype="https://schema.org/WebPage">
  <header class="site-header" role="banner">
    <div class="container header-inner">
      <h1 itemprop="name">Music Hub</h1>
      <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-label="Toggle menu">‚ò∞</button>
      <button id="theme-toggle" class="theme-toggle" title="Toggle theme">üåô</button>
    </div>
    
    <!-- Navigation Links (collapsible on mobile) -->
    <div id="mobile-nav-wrapper" class="mobile-nav-wrapper collapsed">
      <nav class="nav-links" role="navigation" aria-label="Main navigation">
        <a href="/">News</a>
        <a href="/releases">Releases</a>
        <a href="/touring" class="active">Tours</a>
        <a href="/videos">Videos</a>
        <a href="/merch">Merch</a>
        <a href="/subscribe" class="subscribe-link">üìß Subscribe</a>
      </nav>
    </div>
  </header>

  <main class="container tours-page" role="main" itemprop="mainContentOfPage">
    <!-- Page Title -->
    <div class="page-title-section">
      <h2 class="page-title">üé∏ Discover Live Music</h2>
      <p class="page-subtitle">
        {% if view_mode == 'nationwide' %}
          Events across the United States
        {% elif location_query %}
          Events in {{ location_query }}
        {% else %}
          Concerts and events near you
        {% endif %}
      </p>
    </div>

    <!-- Market/Region Tabs -->
    <div class="market-tabs" role="tablist" aria-label="Location filters">
      <a href="/touring" class="market-tab {% if view_mode == 'local' or not view_mode %}active{% endif %}" role="tab" aria-selected="{% if view_mode == 'local' or not view_mode %}true{% else %}false{% endif %}">
        üìç Near You
      </a>
      <a href="/touring?view=nationwide" class="market-tab {% if view_mode == 'nationwide' %}active{% endif %}" role="tab" aria-selected="{% if view_mode == 'nationwide' %}true{% else %}false{% endif %}">
        üåé Nationwide
      </a>
      <a href="/touring?location=New York, NY" class="market-tab">
        üóΩ New York
      </a>
      <a href="/touring?location=Los Angeles, CA" class="market-tab">
        üå¥ Los Angeles
      </a>
      <a href="/touring?location=Chicago, IL" class="market-tab">
        üèôÔ∏è Chicago
      </a>
      <a href="/touring?location=Nashville, TN" class="market-tab">
        üé∏ Nashville
      </a>
      <a href="/touring?location=Austin, TX" class="market-tab">
        ü§† Austin
      </a>
    </div>

    <!-- Advanced Search Toggle Button -->
    <div class="advanced-search-toggle-wrapper">
      <button id="advanced-search-toggle" class="advanced-search-toggle-btn" aria-expanded="false" aria-controls="advanced-filters">
        üîç Advanced Search
      </button>
    </div>

    <!-- Collapsible Filter Buttons -->
    <div id="advanced-filters" class="filter-section" style="display: none;">
      <!-- Genre Filters -->
      <div class="filter-group">
        <span class="filter-label">üéµ Genre:</span>
        <div class="filter-buttons">
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}" 
             class="filter-btn {% if not genre_filter %}active{% endif %}">All</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}genre=rock" 
             class="filter-btn {% if genre_filter == 'rock' %}active{% endif %}">Rock</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}genre=pop" 
             class="filter-btn {% if genre_filter == 'pop' %}active{% endif %}">Pop</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}genre=country" 
             class="filter-btn {% if genre_filter == 'country' %}active{% endif %}">Country</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}genre=hiphop" 
             class="filter-btn {% if genre_filter == 'hiphop' %}active{% endif %}">Hip-Hop</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}genre=rb" 
             class="filter-btn {% if genre_filter == 'rb' %}active{% endif %}">R&B</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'genre' %}{{ key }}={{ value }}&{% endif %}{% endfor %}genre=edm" 
             class="filter-btn {% if genre_filter == 'edm' %}active{% endif %}">EDM</a>
        </div>
      </div>

      <!-- Date Range Filters -->
      <div class="filter-group">
        <span class="filter-label">üìÖ When:</span>
        <div class="filter-buttons">
          <a href="?{% for key, value in request.args.items() %}{% if key != 'date_range' %}{{ key }}={{ value }}&{% endif %}{% endfor %}" 
             class="filter-btn {% if not date_filter %}active{% endif %}">All Dates</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'date_range' %}{{ key }}={{ value }}&{% endif %}{% endfor %}date_range=today" 
             class="filter-btn {% if date_filter == 'today' %}active{% endif %}">Today</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'date_range' %}{{ key }}={{ value }}&{% endif %}{% endfor %}date_range=tomorrow" 
             class="filter-btn {% if date_filter == 'tomorrow' %}active{% endif %}">Tomorrow</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'date_range' %}{{ key }}={{ value }}&{% endif %}{% endfor %}date_range=this_weekend" 
             class="filter-btn {% if date_filter == 'this_weekend' %}active{% endif %}">This Weekend</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'date_range' %}{{ key }}={{ value }}&{% endif %}{% endfor %}date_range=this_week" 
             class="filter-btn {% if date_filter == 'this_week' %}active{% endif %}">This Week</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'date_range' %}{{ key }}={{ value }}&{% endif %}{% endfor %}date_range=next_30" 
             class="filter-btn {% if date_filter == 'next_30' %}active{% endif %}">Next 30 Days</a>
        </div>
      </div>

      <!-- Price Filters -->
      <div class="filter-group">
        <span class="filter-label">üí∞ Price:</span>
        <div class="filter-buttons">
          <a href="?{% for key, value in request.args.items() %}{% if key != 'price' %}{{ key }}={{ value }}&{% endif %}{% endfor %}" 
             class="filter-btn {% if not price_filter %}active{% endif %}">All Prices</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'price' %}{{ key }}={{ value }}&{% endif %}{% endfor %}price=free" 
             class="filter-btn {% if price_filter == 'free' %}active{% endif %}">Free</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'price' %}{{ key }}={{ value }}&{% endif %}{% endfor %}price=under_50" 
             class="filter-btn {% if price_filter == 'under_50' %}active{% endif %}">Under $50</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'price' %}{{ key }}={{ value }}&{% endif %}{% endfor %}price=50_100" 
             class="filter-btn {% if price_filter == '50_100' %}active{% endif %}">$50-$100</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'price' %}{{ key }}={{ value }}&{% endif %}{% endfor %}price=100_200" 
             class="filter-btn {% if price_filter == '100_200' %}active{% endif %}">$100-$200</a>
          <a href="?{% for key, value in request.args.items() %}{% if key != 'price' %}{{ key }}={{ value }}&{% endif %}{% endfor %}price=over_200" 
             class="filter-btn {% if price_filter == 'over_200' %}active{% endif %}">$200+</a>
        </div>
      </div>
    </div>

    <!-- Search Form at Top -->
    <form method="get" action="/touring" class="tour-search-form-top" role="search" aria-label="Concert search">
      <div class="search-container-dual">
        <div class="search-input-wrapper">
          <input 
            type="text" 
            name="artist" 
            placeholder="Search artists, concerts, venues..." 
            value="{{ artist_query or '' }}"
            class="tour-search-input"
            aria-label="Search for artists, concerts, or venues"
          >
        </div>
        <div class="search-input-wrapper search-location">
          <input 
            type="text" 
            name="location" 
            placeholder="City or ZIP code" 
            value="{{ location_query or '' }}"
            class="tour-search-input location-input"
          >
          <span class="location-icon">üìç</span>
        </div>
        <button type="submit" class="tour-search-btn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM18 18l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <button type="button" class="advanced-search-toggle" onclick="toggleAdvancedSearch()">
        Advanced Search
      </button>
    </form>

    <!-- Advanced Search Modal -->
    <div id="advanced-search-modal" class="advanced-search-modal" style="display: none;">
      <div class="advanced-search-content">
        <div class="advanced-search-header">
          <h3>Advanced Search</h3>
          <button class="close-advanced-search" onclick="toggleAdvancedSearch()">‚úï</button>
        </div>
        <form action="/touring" method="get" class="advanced-search-form">
          <div class="advanced-search-field">
            <label for="multi-artist">Artists (one per line):</label>
            <textarea 
              id="multi-artist" 
              name="multi_artist" 
              rows="5" 
              placeholder="e.g.,&#10;Taylor Swift&#10;Beyonc√©&#10;Ed Sheeran"
            >{{ multi_artist or '' }}</textarea>
            <small>Search for multiple artists at once</small>
          </div>
          
          <div class="advanced-search-field">
            <label for="venue-search">Venue Name:</label>
            <input 
              type="text" 
              id="venue-search" 
              name="venue" 
              value="{{ venue_query or '' }}"
              placeholder="e.g., Madison Square Garden"
            >
            <small>Search for events at a specific venue</small>
          </div>
          
          <div class="advanced-search-field">
            <label for="location-advanced">Location:</label>
            <input 
              type="text" 
              id="location-advanced" 
              name="location" 
              value="{{ location_query or '' }}"
              placeholder="City or ZIP code"
            >
          </div>
          
          <div class="advanced-search-checkboxes">
            <label>
              <input type="checkbox" name="festival_only" value="true" {{ 'checked' if festival_only }}>
              Festivals Only
            </label>
          </div>
          
          <div class="advanced-search-actions">
            <button type="submit" class="advanced-search-btn">Search</button>
            <button type="button" class="advanced-search-cancel" onclick="toggleAdvancedSearch()">Cancel</button>
          </div>
        </form>
      </div>
    </div>

    {% if artist_query or multi_artist or venue_query %}
      <!-- Search Results -->
      <div class="tours-header">
        <h2>
          {% if multi_artist %}
            Multi-Artist Search
          {% elif venue_query %}
            {{ venue_query }}
          {% else %}
            {{ artist_query }}
          {% endif %}
        </h2>
        <a href="/touring" class="clear-search-link-header">‚Üê View all events</a>
      </div>

      {% if error %}
        <div class="tour-error">
          <p>{{ error }}</p>
          <p class="error-hint">Try searching for another artist or browse featured events.</p>
        </div>
      {% endif %}

      {% if tours %}
        <section class="carousel-section">
          <div class="carousel-container-search">
            <div class="carousel-track-search">
              {% for event in tours %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}
    {% else %}
      <!-- Multiple Carousels -->
      {% if error %}
        <div class="tour-error">
          <p>{{ error }}</p>
          <p class="error-hint">Try again or check your connection.</p>
        </div>
      {% endif %}

      <!-- Your Artists Carousel (populated via JavaScript) -->
      <section class="carousel-section" id="your-artists-section" style="display: none;">
        <div class="carousel-header">
          <h3 class="carousel-title">‚≠ê Your Artists</h3>
          <div class="carousel-controls">
            <button class="carousel-btn carousel-prev" data-carousel="your-artists">‚Äπ</button>
            <button class="carousel-btn carousel-next" data-carousel="your-artists">‚Ä∫</button>
          </div>
        </div>
        <div class="carousel-container" id="carousel-your-artists">
          <div class="carousel-track">
            <!-- Events will be dynamically loaded here -->
          </div>
        </div>
      </section>

      <!-- Recommended for You Carousel (populated via JavaScript) -->
      <section class="carousel-section" id="recommended-section" style="display: none;">
        <div class="carousel-header">
          <h3 class="carousel-title">üíé Recommended for You</h3>
          <div class="carousel-controls">
            <button class="carousel-btn carousel-prev" data-carousel="recommended">‚Äπ</button>
            <button class="carousel-btn carousel-next" data-carousel="recommended">‚Ä∫</button>
          </div>
        </div>
        <div class="carousel-container" id="carousel-recommended">
          <div class="carousel-track">
            <!-- Events will be dynamically loaded here -->
          </div>
        </div>
      </section>

      <!-- 1. Trending Now Carousel -->
      {% if trending_now %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">üî• Trending Now</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="trending">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="trending">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-trending">
            <div class="carousel-track">
              {% for event in trending_now %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      <!-- 2. Coming Soon Carousel -->
      {% if coming_soon %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">üéüÔ∏è Coming Soon</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="coming">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="coming">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-coming">
            <div class="carousel-track">
              {% for event in coming_soon %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      <!-- 3. Last Chance Carousel -->
      {% if last_chance %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">‚è∞ Last Chance</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="lastchance">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="lastchance">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-lastchance">
            <div class="carousel-track">
              {% for event in last_chance %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      <!-- 4. Nearby Events Carousel -->
      {% if nearby_events %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">üìç Nearby Events</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="nearby">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="nearby">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-nearby">
            <div class="carousel-track">
              {% for event in nearby_events %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      <!-- 5. A-Z Artist Guide Carousel -->
      {% if az_guide %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">üî§ A-Z Artist Guide</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="azguide">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="azguide">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-azguide">
            <div class="carousel-track">
              {% for event in az_guide %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      <!-- 6. Random Discovery Carousel -->
      {% if random_discovery %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">üé≤ Random Discovery</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="random">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="random">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-random">
            <div class="carousel-track">
              {% for event in random_discovery %}
                {% include 'event_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      <!-- 7. Popular Venues Carousel -->
      {% if popular_venues %}
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title">üèüÔ∏è Popular Venues</h3>
            <div class="carousel-controls">
              <button class="carousel-btn carousel-prev" data-carousel="venues">‚Äπ</button>
              <button class="carousel-btn carousel-next" data-carousel="venues">‚Ä∫</button>
            </div>
          </div>
          <div class="carousel-container" id="carousel-venues">
            <div class="carousel-track">
              {% for venue in popular_venues %}
                {% include 'venue_card.html' %}
              {% endfor %}
            </div>
          </div>
        </section>
      {% endif %}

      {% if not trending_now and not error %}
        <!-- Loading State -->
        <div class="loading-indicator active">
          <div class="spinner"></div>
          <p>üéµ Loading featured events...</p>
          <p class="no-tours-hint">Finding the best concerts in your area</p>
        </div>
        
        <!-- Skeleton Cards -->
        <section class="carousel-section">
          <div class="carousel-header">
            <h3 class="carousel-title skeleton" style="width: 200px; height: 28px;"></h3>
          </div>
          <div class="carousel-container">
            <div class="carousel-track">
              <div class="skeleton-card">
                <div class="skeleton-image"></div>
                <div class="skeleton-content">
                  <div class="skeleton-line skeleton"></div>
                  <div class="skeleton-line skeleton medium"></div>
                  <div class="skeleton-line skeleton short"></div>
                  <div class="skeleton-button skeleton"></div>
                </div>
              </div>
              <div class="skeleton-card">
                <div class="skeleton-image"></div>
                <div class="skeleton-content">
                  <div class="skeleton-line skeleton"></div>
                  <div class="skeleton-line skeleton medium"></div>
                  <div class="skeleton-line skeleton short"></div>
                  <div class="skeleton-button skeleton"></div>
                </div>
              </div>
              <div class="skeleton-card">
                <div class="skeleton-image"></div>
                <div class="skeleton-content">
                  <div class="skeleton-line skeleton"></div>
                  <div class="skeleton-line skeleton medium"></div>
                  <div class="skeleton-line skeleton short"></div>
                  <div class="skeleton-button skeleton"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      {% endif %}
    {% endif %}
  </main>

  <style>
    /* Advanced Search Toggle */
    .advanced-search-toggle-wrapper {
      text-align: center;
      margin-bottom: 1rem;
    }

    .advanced-search-toggle-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      color: white;
      border: none;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(236, 72, 153, 0.3);
    }

    .advanced-search-toggle-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(236, 72, 153, 0.5);
    }

    .advanced-search-toggle-btn[aria-expanded="true"]::after {
      content: " ‚ñ≤";
    }

    .advanced-search-toggle-btn[aria-expanded="false"]::after {
      content: " ‚ñº";
    }

    /* Filter Section */
    .filter-section {
      background: var(--bg-secondary);
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 2rem;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
    }

    .filter-group {
      margin-bottom: 1rem;
    }

    .filter-group:last-child {
      margin-bottom: 0;
    }

    .filter-label {
      display: inline-block;
      font-weight: 700;
      font-size: 0.95rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
      margin-right: 0.75rem;
    }

    .filter-buttons {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .filter-btn {
      padding: 0.5rem 1rem;
      border-radius: 20px;
      background: var(--bg-card);
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.875rem;
      font-weight: 600;
      border: 2px solid transparent;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .filter-btn:hover {
      background: var(--bg-primary);
      color: var(--text-primary);
      transform: translateY(-1px);
    }

    .filter-btn.active {
      background: var(--accent-primary);
      color: white;
      border-color: var(--accent-primary);
    }

    /* Loading Skeleton Styles */
    .skeleton {
      background: linear-gradient(90deg, var(--bg-card) 25%, var(--bg-secondary) 50%, var(--bg-card) 75%);
      background-size: 200% 100%;
      animation: loading 1.5s ease-in-out infinite;
      border-radius: 0.5rem;
    }

    @keyframes loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    .skeleton-card {
      flex: 0 0 320px;
      height: 420px;
      background: var(--bg-card);
      border-radius: 1rem;
      overflow: hidden;
      border: 1px solid var(--border-color);
    }

    .skeleton-image {
      width: 100%;
      height: 180px;
      background: linear-gradient(90deg, #2a2a3e 25%, #3a3a4e 50%, #2a2a3e 75%);
      background-size: 200% 100%;
      animation: loading 1.5s ease-in-out infinite;
    }

    .skeleton-content {
      padding: 1rem;
    }

    .skeleton-line {
      height: 1rem;
      margin-bottom: 0.75rem;
      border-radius: 0.25rem;
    }

    .skeleton-line.short {
      width: 60%;
    }

    .skeleton-line.medium {
      width: 80%;
    }

    .skeleton-button {
      height: 48px;
      margin-top: 1rem;
      border-radius: 0.5rem;
    }

    .loading-indicator {
      display: none;
      text-align: center;
      padding: 2rem;
      color: var(--text-secondary);
    }

    .loading-indicator.active {
      display: block;
    }

    .spinner {
      display: inline-block;
      width: 40px;
      height: 40px;
      border: 4px solid var(--bg-secondary);
      border-top-color: var(--accent-primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-bottom: 1rem;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Market Tabs */
    .market-tabs {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.5rem;
      background: var(--bg-secondary);
      border-radius: 12px;
      margin-bottom: 1.5rem;
      overflow-x: auto;
      scrollbar-width: thin;
      -webkit-overflow-scrolling: touch;
    }

    .market-tab {
      padding: 0.75rem 1.25rem;
      border-radius: 8px;
      background: transparent;
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 600;
      font-size: 0.9rem;
      white-space: nowrap;
      transition: all 0.2s;
      border: 2px solid transparent;
    }

    .market-tab:hover {
      background: var(--bg-card);
      color: var(--text-primary);
    }

    .market-tab.active {
      background: var(--accent-primary);
      color: white;
      border-color: var(--accent-primary);
    }

    /* Search Bar at Top */
    .tour-search-form-top {
      max-width: 800px;
      margin: 0 auto 2.5rem;
    }

    .search-container-dual {
      position: relative;
      display: flex;
      gap: 0.5rem;
      align-items: center;
      background: var(--bg-card);
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
      padding: 0.5rem;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .search-container-dual:focus-within {
      border-color: var(--accent-primary);
      box-shadow: 0 6px 24px rgba(236, 72, 153, 0.25);
    }

    .search-input-wrapper {
      flex: 1;
      position: relative;
      min-width: 0;
    }

    .search-location {
      flex: 0 0 200px;
    }

    .tour-search-input {
      width: 100%;
      padding: 0.9rem 1.25rem;
      border: none;
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 0.95rem;
      outline: none;
      border-radius: 8px;
      transition: background 0.2s;
    }

    .tour-search-input:focus {
      background: var(--bg-primary);
    }

    .location-input {
      padding-left: 2.5rem;
    }

    .location-icon {
      position: absolute;
      left: 0.85rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1rem;
      pointer-events: none;
    }

    .tour-search-input::placeholder {
      color: var(--text-secondary);
      opacity: 0.7;
    }

    .tour-search-btn {
      flex-shrink: 0;
      width: 48px;
      height: 48px;
      border: none;
      background: var(--accent-primary);
      color: white;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .tour-search-btn:hover {
      background: var(--accent-hover);
      transform: scale(1.05);
    }

    .tour-search-btn svg {
      width: 20px;
      height: 20px;
    }

    /* Advanced Search Toggle */
    .advanced-search-toggle {
      margin-top: 0.75rem;
      padding: 0.5rem 1rem;
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      font-size: 0.85rem;
      font-weight: 600;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }

    .advanced-search-toggle:hover {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-color: var(--accent-primary);
    }

    /* Advanced Search Modal */
    .advanced-search-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      backdrop-filter: blur(4px);
    }

    .advanced-search-content {
      background: var(--bg-card);
      border-radius: 1rem;
      max-width: 500px;
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 12px 48px rgba(0,0,0,0.3);
      border: 2px solid var(--border-color);
    }

    .advanced-search-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem;
      border-bottom: 1px solid var(--border-color);
    }

    .advanced-search-header h3 {
      margin: 0;
      font-size: 1.5rem;
      color: var(--text-primary);
    }

    .close-advanced-search {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-radius: 50%;
      font-size: 1.25rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-advanced-search:hover {
      background: var(--accent-primary);
      color: white;
    }

    .advanced-search-form {
      padding: 1.5rem;
    }

    .advanced-search-field {
      margin-bottom: 1.5rem;
    }

    .advanced-search-field label {
      display: block;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .advanced-search-field input,
    .advanced-search-field textarea {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-radius: 0.5rem;
      font-size: 0.95rem;
      transition: all 0.2s;
      font-family: inherit;
    }

    .advanced-search-field input:focus,
    .advanced-search-field textarea:focus {
      outline: none;
      border-color: var(--accent-primary);
      background: var(--bg-primary);
    }

    .advanced-search-field small {
      display: block;
      margin-top: 0.35rem;
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    .advanced-search-checkboxes {
      margin-bottom: 1.5rem;
    }

    .advanced-search-checkboxes label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-primary);
      font-weight: 600;
      cursor: pointer;
    }

    .advanced-search-checkboxes input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .advanced-search-actions {
      display: flex;
      gap: 0.75rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-color);
    }

    .advanced-search-btn {
      flex: 1;
      padding: 0.85rem;
      background: var(--accent-primary);
      color: white;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .advanced-search-btn:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
    }

    .advanced-search-cancel {
      flex: 1;
      padding: 0.85rem;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 2px solid var(--border-color);
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .advanced-search-cancel:hover {
      background: var(--bg-primary);
      border-color: var(--accent-primary);
    }

    /* Old search styles for backwards compatibility */
    .search-container {
      position: relative;
      display: flex;
      align-items: center;
      background: var(--bg-card);
      border-radius: 50px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
      overflow: hidden;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .search-container:focus-within {
      border-color: var(--accent-primary);
      box-shadow: 0 6px 24px rgba(236, 72, 153, 0.25);
    }

    .tour-search-input-main {
      flex: 1;
      padding: 1rem 1.5rem;
      border: none;
      background: transparent;
      color: var(--text-primary);
      font-size: 1rem;
      outline: none;
    }

    .tour-search-input-main::placeholder {
      color: var(--text-muted);
    }

    .tour-search-btn-main {
      padding: 1rem 1.5rem;
      border: none;
      background: linear-gradient(135deg, #ec4899, #f59e0b);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .tour-search-btn-main:hover {
      opacity: 0.9;
    }

    .tours-header {
      text-align: center;
      margin: 0 auto 2.5rem;
      max-width: 800px;
    }

    /* Subtitle for all pages */
    .page-subtitle {
      font-size: 1.15rem;
      color: var(--text-secondary);
      margin-top: 0.5rem;
    }

    .clear-search-link-header {
      display: inline-block;
      margin-top: 0.75rem;
      color: var(--accent-primary);
      text-decoration: none;
      font-weight: 600;
      font-size: 0.95rem;
      transition: all 0.2s;
    }

    .clear-search-link-header:hover {
      transform: translateX(-3px);
    }

    .tour-error {
      max-width: 600px;
      margin: 2rem auto;
      padding: 1.5rem;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 1rem;
      text-align: center;
    }

    .tour-error p {
      margin: 0.5rem 0;
      color: var(--text-primary);
    }

    .error-hint {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    /* Bandsintown-Style Grid */
    .tours-grid-bandsintown {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin: 0 auto;
      max-width: 1400px;
    }

    .event-card-bandsintown {
      background: var(--bg-card);
      border-radius: 1.25rem;
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      position: relative;
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }

    .event-card-bandsintown:hover {
      transform: translateY(-8px);
      box-shadow: 0 16px 48px rgba(0,0,0,0.2);
      border-color: var(--accent-primary);
    }

    .event-card-bandsintown:hover .event-hover-overlay {
      opacity: 1;
    }

    .event-image-bandsintown {
      width: 100%;
      height: 320px;
      background-size: cover;
      background-position: center;
      background-color: #1a1a2e;
      position: relative;
    }

    .event-image-placeholder {
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .event-icon-large {
      font-size: 6rem;
      opacity: 0.4;
    }

    .event-content {
      padding: 1.5rem;
      position: relative;
    }

    .event-date-badge {
      position: absolute;
      top: -20px;
      left: 1.5rem;
      background: linear-gradient(135deg, #ec4899, #f59e0b);
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      text-align: center;
      box-shadow: 0 4px 16px rgba(236, 72, 153, 0.4);
      min-width: 70px;
    }

    .badge-month {
      display: block;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      margin-bottom: 0.15rem;
    }

    .badge-day {
      display: block;
      font-size: 1.75rem;
      font-weight: 800;
      line-height: 1;
    }

    .event-info-content {
      margin-top: 0.5rem;
    }

    .event-title {
      font-size: 1.35rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0 0 0.5rem 0;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .event-venue-name {
      font-size: 1rem;
      color: var(--text-primary);
      margin: 0 0 0.25rem 0;
      font-weight: 600;
    }

    .event-location-text {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin: 0 0 1rem 0;
    }

    .event-meta {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .event-status {
      display: inline-block;
      padding: 0.35rem 0.75rem;
      background: rgba(34, 197, 94, 0.15);
      color: #22c55e;
      border-radius: 0.5rem;
      font-size: 0.8rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .event-price {
      display: inline-block;
      padding: 0.35rem 0.75rem;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-radius: 0.5rem;
      font-size: 0.8rem;
      font-weight: 700;
    }

    .event-hover-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.95), rgba(245, 158, 11, 0.95));
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .view-tickets-text {
      color: white;
      font-size: 1.25rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .no-tours {
      text-align: center;
      padding: 4rem 1rem;
      color: var(--text-secondary);
    }

    .no-tours p {
      font-size: 1.2rem;
      margin: 0.5rem 0;
    }

    .no-tours-hint {
      font-size: 1rem;
      color: var(--text-muted);
    }

    .tours-footer {
      text-align: center;
      margin: 4rem auto 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-color);
    }

    .powered-by {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .powered-by a {
      color: var(--accent-primary);
      text-decoration: none;
      font-weight: 600;
    }

    .powered-by a:hover {
      text-decoration: underline;
    }

    /* Carousel Sections */
    .carousel-section {
      margin: 3rem 0;
    }

    .carousel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .carousel-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0;
    }

    .carousel-controls {
      display: flex;
      gap: 0.5rem;
    }

    .carousel-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      background: var(--bg-card);
      color: var(--text-primary);
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .carousel-btn:hover {
      background: var(--accent-primary);
      color: white;
      border-color: var(--accent-primary);
      transform: scale(1.1);
    }

    .carousel-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .carousel-container {
      overflow: hidden;
      position: relative;
    }

    .carousel-track {
      display: flex;
      gap: 1.5rem;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      padding: 0.5rem 0;
    }

    /* Search Results Grid (uses carousel cards) */
    .carousel-container-search {
      overflow: visible;
      position: relative;
    }

    .carousel-track-search {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.5rem;
      padding: 0.5rem 0;
    }

    /* Carousel Event Cards */
    .event-card-carousel {
      flex: 0 0 320px;
      background: var(--bg-card);
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .event-card-link {
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .event-card-carousel:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      border-color: var(--accent-primary);
    }

    /* Ticket Status Badge */
    .ticket-status-badge {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 700;
      z-index: 10;
      backdrop-filter: blur(8px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .ticket-status-badge.selling-fast {
      background: rgba(255, 193, 7, 0.95);
      color: #000;
    }

    .ticket-status-badge.few-left {
      background: rgba(244, 67, 54, 0.95);
      color: white;
    }

    /* Follow Artist Button */
    .follow-artist-btn {
      position: absolute;
      top: 0.75rem;
      left: 0.75rem;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.9);
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .follow-artist-btn:hover {
      transform: scale(1.1);
      background: rgba(0, 0, 0, 0.7);
      border-color: var(--accent-primary);
    }

    .follow-artist-btn.following {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
    }

    .follow-artist-btn.following .follow-icon {
      color: white;
    }

    .follow-icon {
      transition: all 0.2s;
    }

    .venue-rating-badge {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 700;
      z-index: 10;
      background: rgba(255, 215, 0, 0.95);
      color: #000;
      backdrop-filter: blur(8px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .venue-capacity {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin: 0;
      font-weight: 600;
    }

    .event-image-carousel {
      width: 100%;
      height: 180px;
      background-size: cover;
      background-position: center;
      background-color: #1a1a2e;
      position: relative;
    }

    .event-content-carousel {
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      flex: 1;
    }

    .event-date-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-color);
    }

    .event-date-text {
      font-size: 0.85rem;
      color: var(--text-secondary);
      font-weight: 600;
    }

    .event-attendees {
      font-size: 0.85rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .event-title-carousel {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      min-height: 2.6rem;
    }

    .event-venue-carousel {
      font-size: 0.9rem;
      color: var(--text-primary);
      margin: 0;
      font-weight: 600;
    }

    .event-location-carousel {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin: 0 0 0.5rem 0;
    }

    .event-price {
      font-size: 0.9rem;
      color: var(--accent-primary);
      font-weight: 700;
      margin: 0;
    }

    .event-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: auto;
    }

    .event-tickets-btn-carousel {
      flex: 1;
      padding: 0.75rem;
      border: 2px solid var(--accent-primary);
      background: transparent;
      color: var(--accent-primary);
      border-radius: 0.5rem;
      font-weight: 700;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .event-tickets-btn-carousel:hover {
      background: var(--accent-primary);
      color: white;
    }

    .event-calendar-btn {
      flex-shrink: 0;
      width: 48px;
      height: 48px;
      border: 2px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-radius: 0.5rem;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .event-calendar-btn:hover {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
      transform: scale(1.05);
    }

    .event-share-btn {
      flex-shrink: 0;
      width: 48px;
      height: 48px;
      border: 2px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      border-radius: 0.5rem;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .event-share-btn:hover {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
      transform: scale(1.05);
    }

    /* Share Menu */
    .share-menu {
      position: absolute;
      bottom: 60px;
      right: 0;
      background: var(--bg-card);
      border: 2px solid var(--border-color);
      border-radius: 0.75rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
      padding: 0.5rem;
      z-index: 1000;
      min-width: 180px;
      backdrop-filter: blur(10px);
    }

    .share-option {
      width: 100%;
      padding: 0.75rem 1rem;
      border: none;
      background: transparent;
      color: var(--text-primary);
      font-size: 0.95rem;
      font-weight: 600;
      text-align: left;
      cursor: pointer;
      border-radius: 0.5rem;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .share-option:hover {
      background: var(--bg-secondary);
      color: var(--accent-primary);
    }

    .share-icon {
      font-size: 1.1rem;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .filter-section {
        padding: 1rem;
      }

      .filter-group {
        margin-bottom: 1rem;
      }

      .filter-label {
        display: block;
        margin-bottom: 0.6rem;
      }

      .filter-buttons {
        display: flex;
      }

      .filter-btn {
        padding: 0.45rem 0.85rem;
        font-size: 0.8rem;
      }

      .market-tabs {
        gap: 0.4rem;
        padding: 0.4rem;
      }

      .market-tab {
        padding: 0.6rem 1rem;
        font-size: 0.85rem;
      }

      .search-container-dual {
        flex-direction: column;
        gap: 0.5rem;
      }

      .search-input-wrapper,
      .search-location {
        flex: 1;
        width: 100%;
      }

      .tour-search-btn {
        width: 100%;
        height: 44px;
      }

      .tours-grid-bandsintown {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.25rem;
      }
      
      .event-image-bandsintown {
        height: 260px;
      }

      .event-title {
        font-size: 1.2rem;
      }

      .carousel-track-search {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.25rem;
      }
    }

    @media (max-width: 640px) {
      .filter-section {
        padding: 0.85rem;
        margin-bottom: 1.5rem;
      }

      .filter-btn {
        padding: 0.4rem 0.75rem;
        font-size: 0.75rem;
      }

      .market-tabs {
        margin-bottom: 1rem;
        justify-content: flex-start;
      }

      .market-tab {
        padding: 0.55rem 0.85rem;
        font-size: 0.8rem;
      }

      .advanced-search-toggle-btn {
        padding: 0.65rem 1.25rem;
        font-size: 0.85rem;
      }

      .tours-header {
        margin-bottom: 1.5rem;
      }

      .page-subtitle {
        font-size: 1rem;
      }

      .tour-search-input {
        font-size: 0.9rem;
        padding: 0.8rem 1rem;
      }

      .location-input {
        padding-left: 2.25rem;
      }

      .tour-search-input-main {
        font-size: 0.95rem;
        padding: 0.85rem 1.25rem;
      }

      .tours-grid-bandsintown {
        grid-template-columns: 1fr;
        gap: 1.25rem;
      }

      .event-image-bandsintown {
        height: 240px;
      }

      .event-content {
        padding: 1.25rem;
      }

      .event-date-badge {
        top: -18px;
        left: 1.25rem;
        padding: 0.6rem 0.85rem;
      }

      .badge-day {
        font-size: 1.5rem;
      }

      .carousel-title {
        font-size: 1.4rem;
      }

      .carousel-btn {
        width: 36px;
        height: 36px;
        font-size: 1.3rem;
      }

      .event-card-carousel {
        flex: 0 0 280px;
      }

      .event-image-carousel {
        height: 160px;
      }

      .event-content-carousel {
        padding: 0.85rem;
        gap: 0.6rem;
      }

      .event-title-carousel {
        font-size: 1rem;
        min-height: 2.4rem;
      }

      .event-tickets-btn-carousel {
        padding: 0.65rem;
        font-size: 0.85rem;
      }

      .carousel-track-search {
        grid-template-columns: 1fr;
        gap: 1.25rem;
      }
    }
  </style>

  <script>
    // Advanced Search Toggle
    document.addEventListener('DOMContentLoaded', function() {
      const toggleBtn = document.getElementById('advanced-search-toggle');
      const filtersSection = document.getElementById('advanced-filters');
      
      if (toggleBtn && filtersSection) {
        toggleBtn.addEventListener('click', function() {
          const isExpanded = this.getAttribute('aria-expanded') === 'true';
          
          if (isExpanded) {
            filtersSection.style.display = 'none';
            this.setAttribute('aria-expanded', 'false');
          } else {
            filtersSection.style.display = 'block';
            this.setAttribute('aria-expanded', 'true');
          }
        });
      }
    });

    // Artist Following System with localStorage
    function getFollowedArtists() {
      const stored = localStorage.getItem('followedArtists');
      return stored ? JSON.parse(stored) : [];
    }

    function saveFollowedArtists(artists) {
      localStorage.setItem('followedArtists', JSON.stringify(artists));
    }

    function isFollowingArtist(artistName) {
      const followed = getFollowedArtists();
      return followed.includes(artistName);
    }

    function toggleFollowArtist(event, artistName) {
      event.preventDefault();
      event.stopPropagation();
      
      const button = event.currentTarget;
      const followed = getFollowedArtists();
      const index = followed.indexOf(artistName);
      
      if (index > -1) {
        // Unfollow
        followed.splice(index, 1);
        button.classList.remove('following');
        button.querySelector('.follow-icon').textContent = '‚ô°';
        button.title = 'Follow Artist';
      } else {
        // Follow
        followed.push(artistName);
        button.classList.add('following');
        button.querySelector('.follow-icon').textContent = '‚ô•';
        button.title = 'Unfollow Artist';
      }
      
      saveFollowedArtists(followed);
    }

    // Initialize follow button states on page load
    function initializeFollowButtons() {
      const followButtons = document.querySelectorAll('.follow-artist-btn');
      followButtons.forEach(button => {
        const artistName = button.dataset.artist;
        if (isFollowingArtist(artistName)) {
          button.classList.add('following');
          button.querySelector('.follow-icon').textContent = '‚ô•';
          button.title = 'Unfollow Artist';
        }
      });
    }

    // Social Sharing Functions
    function toggleShareMenu(event, eventName, ticketUrl) {
      event.preventDefault();
      event.stopPropagation();
      
      const shareBtn = event.currentTarget;
      const eventCard = shareBtn.closest('.event-card-carousel');
      const shareMenu = eventCard.querySelector('.share-menu');
      
      // Close all other share menus
      document.querySelectorAll('.share-menu').forEach(menu => {
        if (menu !== shareMenu) {
          menu.style.display = 'none';
        }
      });
      
      // Toggle this menu
      shareMenu.style.display = shareMenu.style.display === 'none' ? 'block' : 'none';
    }

    function shareOnFacebook(event, url) {
      event.preventDefault();
      event.stopPropagation();
      const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
      window.open(facebookUrl, '_blank', 'width=600,height=400');
      hideShareMenus();
    }

    function shareOnTwitter(event, eventName, url) {
      event.preventDefault();
      event.stopPropagation();
      const text = `Check out ${eventName}! üéµ`;
      const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
      window.open(twitterUrl, '_blank', 'width=600,height=400');
      hideShareMenus();
    }

    function shareOnWhatsApp(event, eventName, url) {
      event.preventDefault();
      event.stopPropagation();
      const text = `Check out ${eventName}! üéµ ${url}`;
      const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text)}`;
      window.open(whatsappUrl, '_blank');
      hideShareMenus();
    }

    function copyEventLink(event, url) {
      event.preventDefault();
      event.stopPropagation();
      
      navigator.clipboard.writeText(url).then(() => {
        const btn = event.currentTarget;
        const originalText = btn.innerHTML;
        btn.innerHTML = '<span class="share-icon">‚úì</span> Copied!';
        btn.style.color = 'var(--accent-primary)';
        
        setTimeout(() => {
          btn.innerHTML = originalText;
          btn.style.color = '';
          hideShareMenus();
        }, 2000);
      }).catch(err => {
        console.error('Failed to copy link:', err);
        alert('Failed to copy link. Please try again.');
      });
    }

    function hideShareMenus() {
      document.querySelectorAll('.share-menu').forEach(menu => {
        menu.style.display = 'none';
      });
    }

    // Close share menus when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.event-share-btn') && !e.target.closest('.share-menu')) {
        hideShareMenus();
      }
    });

    // Advanced Search Modal
    function toggleAdvancedSearch() {
      const modal = document.getElementById('advanced-search-modal');
      if (modal.style.display === 'none') {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      } else {
        modal.style.display = 'none';
        document.body.style.overflow = '';
      }
    }

    // Close advanced search modal when clicking outside
    document.addEventListener('click', function(e) {
      const modal = document.getElementById('advanced-search-modal');
      if (e.target === modal) {
        toggleAdvancedSearch();
      }
    });

    // Add to Calendar function
    function addToCalendar(e, eventName, venueName, dateTime, ticketUrl) {
      e.preventDefault();
      e.stopPropagation();
      
      if (!dateTime || dateTime === 'TBA') {
        alert('Event date is not available yet.');
        return;
      }
      
      // Parse the ISO date
      const eventDate = new Date(dateTime);
      const endDate = new Date(eventDate.getTime() + 3 * 60 * 60 * 1000); // 3 hours later
      
      // Format dates for calendar (YYYYMMDDTHHMMSSZ)
      const formatDate = (date) => {
        return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
      };
      
      const startStr = formatDate(eventDate);
      const endStr = formatDate(endDate);
      
      // Create calendar description
      const description = `Concert at ${venueName}\\n\\nGet tickets: ${ticketUrl}`;
      const location = venueName;
      
      // Google Calendar URL
      const googleUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventName)}&dates=${startStr}/${endStr}&details=${encodeURIComponent(description)}&location=${encodeURIComponent(location)}`;
      
      // Open in new window
      window.open(googleUrl, '_blank', 'width=600,height=600');
    }

    // Geolocation functionality to show concerts near user
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize follow button states
      initializeFollowButtons();
      
      // Check if we already have location or if user searched for specific location
      const urlParams = new URLSearchParams(window.location.search);
      const hasLocation = urlParams.has('latlong') || urlParams.has('location');
      const hasArtist = urlParams.has('artist');
      const viewMode = urlParams.get('view');
      
      // Only get location if in 'local' mode (or no view specified) and no location set
      if (!hasLocation && !hasArtist && viewMode !== 'nationwide') {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            function(position) {
              // Got user's location, reload page with location params
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;
              const latlong = lat + ',' + lon;
              
              // Reload the page with location
              const newUrl = window.location.pathname + '?latlong=' + encodeURIComponent(latlong) + '&radius=50';
              window.location.href = newUrl;
            },
            function(error) {
              // User denied or error occurred, just show default results
              console.log('Geolocation error:', error.message);
            },
            {
              timeout: 5000,
              maximumAge: 300000 // Cache for 5 minutes
            }
          );
        }
      }
      
      // Update form to include location when searching
      const searchForm = document.querySelector('.tour-search-form-top');
      if (searchForm && hasLocation) {
        searchForm.addEventListener('submit', function(e) {
          const latlongValue = urlParams.get('latlong');
          if (latlongValue) {
            const hiddenInput = document.createElement('input');
            hiddenInput.type = 'hidden';
            hiddenInput.name = 'latlong';
            hiddenInput.value = latlongValue;
            searchForm.appendChild(hiddenInput);
          }
        });
      }

      // Carousel functionality
      function initCarousels() {
        const carouselIds = ['trending', 'coming', 'lastchance', 'nearby', 'azguide', 'random', 'venues'];
        
        carouselIds.forEach(id => {
          const container = document.getElementById('carousel-' + id);
          if (!container) return;
          
          const track = container.querySelector('.carousel-track');
          const prevBtn = document.querySelector(`[data-carousel="${id}"].carousel-prev`);
          const nextBtn = document.querySelector(`[data-carousel="${id}"].carousel-next`);
          
          if (!track || !prevBtn || !nextBtn) return;
          
          let currentIndex = 0;
          const cardWidth = 320 + 24; // card width + gap
          const visibleCards = Math.floor(container.offsetWidth / cardWidth);
          const totalCards = track.children.length;
          const maxIndex = Math.max(0, totalCards - visibleCards);
          
          // Touch/swipe support
          let touchStartX = 0;
          let touchEndX = 0;
          let isDragging = false;
          let startTransform = 0;
          let currentTransform = 0;
          
          function updateCarousel(smooth = true) {
            const offset = -currentIndex * cardWidth;
            track.style.transition = smooth ? 'transform 0.3s ease-out' : 'none';
            track.style.transform = `translateX(${offset}px)`;
            
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex >= maxIndex;
          }
          
          prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
              currentIndex--;
              updateCarousel();
            }
          });
          
          nextBtn.addEventListener('click', () => {
            if (currentIndex < maxIndex) {
              currentIndex++;
              updateCarousel();
            }
          });
          
          // Touch events for swipe
          track.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            isDragging = true;
            startTransform = -currentIndex * cardWidth;
            track.style.transition = 'none';
          }, { passive: true });
          
          track.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            touchEndX = e.touches[0].clientX;
            const diff = touchEndX - touchStartX;
            currentTransform = startTransform + diff;
            
            // Add boundaries
            const minTransform = -maxIndex * cardWidth;
            const maxTransform = 0;
            currentTransform = Math.max(minTransform, Math.min(maxTransform, currentTransform));
            
            track.style.transform = `translateX(${currentTransform}px)`;
          }, { passive: true });
          
          track.addEventListener('touchend', () => {
            if (!isDragging) return;
            isDragging = false;
            
            const diff = touchEndX - touchStartX;
            const threshold = 50; // Minimum swipe distance
            
            if (Math.abs(diff) > threshold) {
              if (diff > 0 && currentIndex > 0) {
                // Swiped right - go to previous
                currentIndex--;
              } else if (diff < 0 && currentIndex < maxIndex) {
                // Swiped left - go to next
                currentIndex++;
              }
            }
            
            updateCarousel();
            touchStartX = 0;
            touchEndX = 0;
          });
          
          // Mouse drag support for desktop
          let mouseStartX = 0;
          let mouseDown = false;
          
          track.addEventListener('mousedown', (e) => {
            mouseStartX = e.clientX;
            mouseDown = true;
            startTransform = -currentIndex * cardWidth;
            track.style.transition = 'none';
            track.style.cursor = 'grabbing';
            e.preventDefault();
          });
          
          track.addEventListener('mousemove', (e) => {
            if (!mouseDown) return;
            const diff = e.clientX - mouseStartX;
            currentTransform = startTransform + diff;
            
            const minTransform = -maxIndex * cardWidth;
            const maxTransform = 0;
            currentTransform = Math.max(minTransform, Math.min(maxTransform, currentTransform));
            
            track.style.transform = `translateX(${currentTransform}px)`;
          });
          
          track.addEventListener('mouseup', (e) => {
            if (!mouseDown) return;
            mouseDown = false;
            track.style.cursor = 'grab';
            
            const diff = e.clientX - mouseStartX;
            const threshold = 50;
            
            if (Math.abs(diff) > threshold) {
              if (diff > 0 && currentIndex > 0) {
                currentIndex--;
              } else if (diff < 0 && currentIndex < maxIndex) {
                currentIndex++;
              }
            }
            
            updateCarousel();
            mouseStartX = 0;
          });
          
          track.addEventListener('mouseleave', () => {
            if (mouseDown) {
              mouseDown = false;
              track.style.cursor = 'grab';
              updateCarousel();
            }
          });
          
          // Update on window resize
          let resizeTimer;
          window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
              const newVisibleCards = Math.floor(container.offsetWidth / cardWidth);
              const newMaxIndex = Math.max(0, totalCards - newVisibleCards);
              if (currentIndex > newMaxIndex) {
                currentIndex = newMaxIndex;
              }
              updateCarousel();
            }, 250);
          });
          
          // Set initial cursor
          track.style.cursor = 'grab';
          updateCarousel();
        });
      }
      
      // Initialize carousels after DOM is ready
      initCarousels();
      
      // Load Your Artists carousel
      loadYourArtistsCarousel();
      
      // Load Recommended for You carousel
      loadRecommendedCarousel();
    });

    // Load events from followed artists
    async function loadYourArtistsCarousel() {
      const section = document.getElementById('your-artists-section');
      if (!section) return; // Section doesn't exist
      
      const followedArtists = getFollowedArtists();
      
      if (followedArtists.length === 0) {
        // Hide the carousel if no artists followed
        section.style.display = 'none';
        return;
      }
      
      // Show the carousel
      section.style.display = 'block';
      
      // Fetch events for followed artists
      const track = document.querySelector('#carousel-your-artists .carousel-track');
      track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">Loading your artists...</div>';
      
      try {
        // Fetch events for each artist and combine
        const allEvents = [];
        console.log('Fetching events for followed artists:', followedArtists);
        for (const artist of followedArtists.slice(0, 10)) { // Limit to 10 artists
          const url = `/api/artist-events?artist=${encodeURIComponent(artist)}`;
          console.log('Fetching:', url);
          const response = await fetch(url);
          console.log('Response status:', response.status);
          if (response.ok) {
            const data = await response.json();
            console.log('Data received:', data);
            if (data.events) {
              allEvents.push(...data.events.slice(0, 5)); // Max 5 events per artist
            }
          }
        }
        
        // Sort by date
        allEvents.sort((a, b) => {
          if (!a.datetime) return 1;
          if (!b.datetime) return -1;
          return new Date(a.datetime) - new Date(b.datetime);
        });
        
        // Render events
        if (allEvents.length > 0) {
          track.innerHTML = allEvents.map(event => renderEventCard(event)).join('');
          // Re-initialize follow buttons for the new cards
          initializeFollowButtons();
        } else {
          track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">No upcoming events found for your followed artists.</div>';
        }
      } catch (error) {
        console.error('Error loading your artists events:', error);
        track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">Unable to load events. Please try again later.</div>';
      }
    }

    // Load recommended events based on user preferences
    async function loadRecommendedCarousel() {
      const section = document.getElementById('recommended-section');
      if (!section) return; // Section doesn't exist
      
      const followedArtists = getFollowedArtists();
      
      if (followedArtists.length === 0) {
        // Hide the carousel if no preferences
        section.style.display = 'none';
        return;
      }
      
      // Show the carousel
      section.style.display = 'block';
      
      const track = document.querySelector('#carousel-recommended .carousel-track');
      track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">Finding recommendations...</div>';
      
      try {
        // Get the current location parameters
        const urlParams = new URLSearchParams(window.location.search);
        const latlong = urlParams.get('latlong') || '';
        const radius = urlParams.get('radius') || '50';
        
        // Fetch trending events (similar to what you might like)
        const params = new URLSearchParams({
          limit: 30,
          sort: 'relevance,desc'
        });
        
        if (latlong) {
          params.append('latlong', latlong);
          params.append('radius', radius);
        }
        
        // Use Ticketmaster API to get general popular events
        const response = await fetch(`/api/recommended-events?${params.toString()}`);
        
        if (response.ok) {
          const data = await response.json();
          
          if (data.events && data.events.length > 0) {
            // Filter out events from artists already followed
            const recommendedEvents = data.events.filter(event => 
              !followedArtists.includes(event.artist)
            ).slice(0, 20);
            
            if (recommendedEvents.length > 0) {
              track.innerHTML = recommendedEvents.map(event => renderEventCard(event)).join('');
              initializeFollowButtons();
            } else {
              track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">No new recommendations at this time. Follow more artists to improve recommendations!</div>';
            }
          } else {
            track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">No recommendations available right now.</div>';
          }
        } else {
          track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">Unable to load recommendations.</div>';
        }
      } catch (error) {
        console.error('Error loading recommendations:', error);
        track.innerHTML = '<div style="padding: 2rem; text-align: center; width: 100%; color: var(--text-secondary);">Unable to load recommendations. Please try again later.</div>';
      }
    }

    // Helper function to render an event card
    function renderEventCard(event) {
      const randomStatus = Math.floor(Math.random() * 10) + 1;
      let statusBadge = '';
      if (randomStatus <= 3) {
        statusBadge = '<div class="ticket-status-badge selling-fast">‚ö° Selling Fast</div>';
      } else if (randomStatus <= 5) {
        statusBadge = '<div class="ticket-status-badge few-left">üî• Few Left</div>';
      }
      
      const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      let dateText = 'TBA';
      if (event.datetime) {
        const date = new Date(event.datetime);
        dateText = monthNames[date.getMonth()] + ' ' + date.getDate();
      }
      
      const attendees = Math.floor(Math.random() * 900) + 100;
      const imageSrc = event.artist_image || '';
      const imageHtml = imageSrc 
        ? `<div class="event-image-carousel" style="background-image: url('${imageSrc}');"></div>`
        : `<div class="event-image-carousel event-image-placeholder"><span class="event-icon-large">üéµ</span></div>`;
      
      const priceHtml = event.price_range ? `<p class="event-price">${event.price_range}</p>` : '';
      
      return `
        <div class="event-card-carousel">
          <a href="${event.ticket_url}" target="_blank" rel="noopener noreferrer" class="event-card-link">
            ${imageHtml}
            ${statusBadge}
            <button class="follow-artist-btn" 
                    onclick="toggleFollowArtist(event, '${event.artist.replace(/'/g, "\\'")}'); return false;" 
                    data-artist="${event.artist}"
                    title="Follow Artist">
              <span class="follow-icon">‚ô°</span>
            </button>
            <div class="event-content-carousel">
              <div class="event-date-info">
                <span class="event-date-text">${dateText}</span>
                <span class="event-attendees">üë• ${attendees}</span>
              </div>
              <h4 class="event-title-carousel">${event.event_name || event.artist}</h4>
              <p class="event-venue-carousel">${event.venue_name}</p>
              <p class="event-location-carousel">${event.city}${event.region ? ', ' + event.region : ''}</p>
              ${priceHtml}
              <div class="event-actions">
                <button class="event-tickets-btn-carousel">Get Tickets</button>
                <button class="event-calendar-btn" onclick="addToCalendar(event, '${(event.event_name || event.artist).replace(/'/g, "\\'")}', '${event.venue_name.replace(/'/g, "\\'")}', '${event.datetime}', '${event.ticket_url}'); return false;" title="Add to Calendar">
                  üìÖ
                </button>
                <button class="event-share-btn" onclick="toggleShareMenu(event, '${(event.event_name || event.artist).replace(/'/g, "\\'")}', '${event.ticket_url}'); return false;" title="Share Event">
                  üîó
                </button>
              </div>
              <div class="share-menu" style="display: none;">
                <button class="share-option" onclick="shareOnFacebook(event, '${event.ticket_url}'); return false;">
                  <span class="share-icon">üìò</span> Facebook
                </button>
                <button class="share-option" onclick="shareOnTwitter(event, '${(event.event_name || event.artist).replace(/'/g, "\\'")}', '${event.ticket_url}'); return false;">
                  <span class="share-icon">üê¶</span> Twitter
                </button>
                <button class="share-option" onclick="shareOnWhatsApp(event, '${(event.event_name || event.artist).replace(/'/g, "\\'")}', '${event.ticket_url}'); return false;">
                  <span class="share-icon">üí¨</span> WhatsApp
                </button>
                <button class="share-option" onclick="copyEventLink(event, '${event.ticket_url}'); return false;">
                  <span class="share-icon">üìã</span> Copy Link
                </button>
              </div>
            </div>
          </a>
        </div>
      `;
    }
  </script>
</body>
</html>
